<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
    <!-- Critical CSS Inline - Above the fold styles -->
    <style>
      /* Critical above-the-fold styles to prevent layout shift */
      :root {
        --background: 0 0% 100%;
        --foreground: 224 71% 4%;
        --primary: 262 83% 58%;
        --primary-foreground: 210 20% 98%;
        --radius: 0.75rem;
        --border: 220 13% 91%;
        --card: 0 0% 100%;
        --card-foreground: 224 71% 4%;
      }
      
      [class*="dark"] {
        --background: 224 71% 4%;
        --foreground: 210 20% 98%;
        --border: 215 27% 16%;
        --card: 224 71% 4%;
        --card-foreground: 210 20% 98%;
      }
      
      * {
        border-color: hsl(var(--border));
      }
      
      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }
      
      body {
        background-color: hsl(var(--background));
        color: hsl(var(--foreground));
        font-feature-settings: "rlig" 1, "calt" 1;
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        line-height: 1.5;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      
      #root {
        min-height: 100vh;
      }
      
      /* Critical loading state */
      .loading-fallback {
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        font-size: 1.125rem;
        background: linear-gradient(180deg, hsl(var(--background)), hsl(220 14% 98%));
      }
      
      /* Critical button styles to prevent layout shift */
      .btn-critical {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border-radius: calc(var(--radius) - 2px);
        font-size: 0.875rem;
        font-weight: 500;
        padding: 0.5rem 1rem;
        transition: all 0.15s ease-in-out;
        border: 1px solid hsl(var(--border));
        background-color: hsl(var(--card));
        color: hsl(var(--card-foreground));
        cursor: pointer;
      }
      
      .btn-critical:hover {
        background-color: hsl(var(--primary));
        color: hsl(var(--primary-foreground));
      }
    </style>
    
    <!-- Preload Google Fonts with font-display: swap -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap"></noscript>
    
    <!-- Resource Hints for Performance -->
    <link rel="preconnect" href="https://uktpbcpzzxbbsoixiioq.supabase.co" crossorigin>
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
    <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
    <link rel="dns-prefetch" href="https://analytics.google.com">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https: https://www.google-analytics.com; font-src 'self' data:; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://www.google-analytics.com https://analytics.google.com; media-src 'self' blob: https:; object-src 'none'; base-uri 'self'; form-action 'self';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta name="referrer" content="strict-origin-when-cross-origin">

    <!-- Google Analytics - Optimized loading -->
    <script>
      // Defer Google Analytics loading
      window.addEventListener('load', function() {
        var script = document.createElement('script');
        script.async = true;
        script.src = 'https://www.googletagmanager.com/gtag/js?id=G-GMZBD0VN6W';
        document.head.appendChild(script);
        
        script.onload = function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() { dataLayer.push(arguments); }
          gtag('js', new Date());
          gtag('config', 'G-GMZBD0VN6W');
        };
      });
    </script>

    <!-- Favicon with preload for critical icons -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="preload" as="image" href="/icon-192x192.png" type="image/png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/icon-192x192.png" />
    <link rel="apple-touch-icon" sizes="512x512" href="/icon-512x512.png" />

    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json" />
    <meta name="theme-color" content="#6366f1" />

    <title>Wish Wall</title>
    <meta name="description" content="A beautiful wall where wishes come to life" />
    <meta name="author" content="Wish Wall" />

    <meta property="og:title" content="Wish Wall" />
    <meta property="og:description" content="A beautiful wall where wishes come to life" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/icon-512x512.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@wishwall" />
    <meta name="twitter:image" content="/icon-512x512.png" />
  </head>

  <body>
    <div id="root">
      <!-- Critical loading fallback to prevent layout shift -->
      <div class="loading-fallback">Loading...</div>
    </div>
    
    <!-- Defer CSS loading to prevent render blocking -->
    <script>
      // Load CSS asynchronously after critical render
      const loadCSS = function(href) {
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = href;
        link.media = 'print';
        link.onload = function() { this.media = 'all'; };
        document.head.appendChild(link);
      };
      
      // Wait for Vite to inject the CSS href, then load it asynchronously
      window.addEventListener('DOMContentLoaded', function() {
        // Find the CSS link that Vite will inject
        const stylesheets = document.querySelectorAll('link[rel="stylesheet"]');
        stylesheets.forEach(function(stylesheet) {
          if (stylesheet.href.includes('/assets/index-') && stylesheet.href.endsWith('.css')) {
            // Remove the render-blocking stylesheet
            const href = stylesheet.href;
            stylesheet.remove();
            
            // Load it asynchronously
            setTimeout(function() {
              loadCSS(href);
            }, 0);
          }
        });
      });
    </script>
    
    <!-- Optimized module loading -->
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Preload critical resources hint for future optimization -->
    <script>
      // Preload critical Supabase connection early
      if ('serviceWorker' in navigator) {
        // Only preload if service worker is supported (modern browsers)
        const link = document.createElement('link');
        link.rel = 'prefetch';
        link.href = 'https://uktpbcpzzxbbsoixiioq.supabase.co/rest/v1/';
        document.head.appendChild(link);
      }
    </script>
  </body>

</html>
